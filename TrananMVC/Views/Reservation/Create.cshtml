@model TrananMVC.ViewModel.MovieScreeningReservationViewModel
@{
    ViewData["Title"] = "Reservera biljetter";
}

<div class="movie-poster">
    <a asp-controller="Movie" asp-action="Details" asp-route-movieId="@Model.MovieScreeningViewModel.MovieId">
        <img src="@Html.Raw(Model.MovieScreeningViewModel.MovieImageUrl)" />
    </a>
</div>

@using (Html.BeginForm("PostReservation", "Reservation", FormMethod.Post))
{
    <h4>Välj stolar:</h4>
    @foreach (var seat in Model.MovieScreeningViewModel.AvailableSeats)
    {
        <div>
            <input type="checkbox" name="ReservationViewModel.SeatIds" value="@seat.SeatId">
            <label for="seat-@seat.SeatId">Rad: @seat.Row Stolnummer: @seat.SeatNumber</label>
        </div>
    }

    <h4>Förnamn: </h4> <input type="text" name="ReservationViewModel.CustomerViewModel.FirstName"
        value="@Model.ReservationViewModel.CustomerViewModel.FirstName">
    <h4>Efternamn: </h4> <input type="text" name="ReservationViewModel.CustomerViewModel.LastName"
        value="@Model.ReservationViewModel.CustomerViewModel.LastName">
    <h4>Telefonnummer: </h4> <input type="number" name="ReservationViewModel.CustomerViewModel.PhoneNumber"
        value="@Model.ReservationViewModel.CustomerViewModel.PhoneNumber">
    <h4>Email: </h4> <input type="email" name="ReservationViewModel.CustomerViewModel.Email"
        value="@Model.ReservationViewModel.CustomerViewModel.Email">

    <input type="hidden" name="ReservationViewModel.MovieScreeningId"
        value="@Model.ReservationViewModel.MovieScreeningId" />


    <p id="total-price">Totala pris: @Model.ReservationViewModel.Price</p>

    <input type="hidden" name="ReservationViewModel.MovieScreeningId"
        value="@Model.MovieScreeningViewModel.MovieScreeningId" />
    <input type="hidden" name="ReservationViewModel.Price" value="@Model.ReservationViewModel.Price" />

    <button type="submit" id="button">Reservera</button>

    <script>
        const checkboxes = document.querySelectorAll('input[type=checkbox]');
        const currentPrice = document.getElementById('total-price');
        const pricePerPerson = @Model.MovieScreeningViewModel.PricePerPerson;

        let totalPrice = 0;

        checkboxes.forEach(function (checkbox) {
            checkbox.addEventListener('change', function () {
                if (this.checked) {
                    totalPrice += pricePerPerson;
                } else {
                    totalPrice -= pricePerPerson;
                }
                currentPrice.innerText = "Totala pris: " + totalPrice;
            });
        });


    </script>
}






